<%- include('partials/header') %>

<div class="container mt-4">
	<div class="d-flex justify-content-center">
		<h1>User Signup Form</h1>
	</div>
	<div class="d-flex justify-content-center align-items-center">
		<form onsubmit="return validate(this)">
			<div>
				<label for="username" class="form-label">Username</label>
				<input type="text" name="username" id="username" placeholder="username" class="form-control mb-3" />
			</div>
			<div>
				<label for="password" class="form-label">password</label>
				<input type="password" name="password" id="password" placeholder="password" class="form-control mb-3" />
			</div>
			<button class="btn btn-primary">Sign Up</button>
		</form>
	</div>
</div>

<script>
	function validate(element) {
		const username = element.username.value;
		const password = element.password.value;

		if (username.length < 3) {
			alert('Username must be at least 3 characters');
			return false;
		}
		if (password.length < 3) {
			alert('Password must be at least 3 characters');
			return false;
		}

		var myHeaders = new Headers();
		myHeaders.append('Content-Type', 'application/json');

		var requestOptions = {
			method: 'POST',
			headers: myHeaders,
			body: JSON.stringify({ username, password }),
			redirect: 'follow',
		};

		fetch(window.location.href, requestOptions)
			.then((response) => {
				if (response.status == 200) {
					alert('User created successfully');
					window.location.href = '/';
				} else if (response.status == 400) {
					alert('User already exists');
				}
			})
			.catch((error) => console.log('error', error));

		return false;
	}
</script>

<%- include('partials/footer') %>
